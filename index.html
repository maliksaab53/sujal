<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 25.2.3.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.27in 11.69in; margin: 0.79in }
		p { margin-bottom: 0.1in; line-height: 115%; background: transparent }
		pre { font-size: 10pt; font-family: "Liberation Mono", monospace; background: transparent }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><pre>&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot; /&gt;
  &lt;title&gt;Dynamic OPD Dashboard&lt;/title&gt;
  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;&gt;&lt;/script&gt;
  &lt;style&gt;
    :root{--accent:#2563eb;--card:#ffffff;--bg:#f3f4f6;--muted:#6b7280}
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,&quot;Helvetica Neue&quot;,Arial}
    body{margin:0;background:var(--bg);padding:20px}
    .container{max-width:1200px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:12px}
    h1{font-size:20px;margin:0}
    .top-right{display:flex;gap:12px;align-items:center}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
    .summary{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:18px}
    .summary .item{padding:12px;border-radius:10px}
    .grid{display:grid;grid-template-columns:2fr 1fr;gap:16px}
    .chart-area{padding:12px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;text-align:left;border-bottom:1px solid #eee}
    th{color:var(--muted);font-weight:600}
    .hospital-name{font-size:18px;font-weight:700;color:var(--accent);text-align:center;padding:10px}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{background:var(--accent);color:white;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    .uploader{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    input[type=file], input[type=date], input[type=text]{display:block;padding:6px}
    @media (max-width:900px){.summary{grid-template-columns:repeat(2,1fr)}.grid{grid-template-columns:1fr}}
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;container&quot;&gt;
    &lt;header&gt;
      &lt;div&gt;
        &lt;h1&gt;Dynamic OPD Dashboard&lt;/h1&gt;
        &lt;div class=&quot;muted&quot;&gt;Upload daily OPD reports. Data saves locally &amp; can be exported as Excel.&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class=&quot;top-right&quot;&gt;
        &lt;div class=&quot;card hospital-name&quot;&gt;Sania Multi &amp; Super Speciality Hospital&lt;/div&gt;
        &lt;div class=&quot;card&quot; id=&quot;clock&quot;&gt;Loading time...&lt;/div&gt;
      &lt;/div&gt;
    &lt;/header&gt;

    &lt;div style=&quot;margin-bottom:12px&quot; class=&quot;card uploader&quot;&gt;
      &lt;div&gt;
        &lt;label class=&quot;muted&quot;&gt;Choose data file (PDF / JSON / CSV)&lt;/label&gt;
        &lt;input id=&quot;fileInput&quot; type=&quot;file&quot; accept=&quot;.pdf,.json,.csv&quot; /&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;label class=&quot;muted&quot;&gt;Filter by Date&lt;/label&gt;
        &lt;input id=&quot;dateFilter&quot; type=&quot;date&quot; /&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;label class=&quot;muted&quot;&gt;Search Doctor&lt;/label&gt;
        &lt;input id=&quot;searchDoctor&quot; type=&quot;text&quot; placeholder=&quot;Type name...&quot; /&gt;
      &lt;/div&gt;
      &lt;div style=&quot;margin-left:auto;display:flex;gap:8px;flex-wrap:wrap&quot;&gt;
        &lt;button id=&quot;loadSample&quot;&gt;Load Sample Data&lt;/button&gt;
        &lt;button id=&quot;clearData&quot;&gt;Clear All&lt;/button&gt;
        &lt;button id=&quot;exportExcel&quot;&gt;Download Excel&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;section class=&quot;summary&quot;&gt;
      &lt;div class=&quot;card item&quot;&gt;&lt;div class=&quot;muted&quot;&gt;Total Self OPD Patients&lt;/div&gt;&lt;div id=&quot;totalSelfPatients&quot; style=&quot;font-size:18px;font-weight:700&quot;&gt;—&lt;/div&gt;&lt;/div&gt;
      &lt;div class=&quot;card item&quot;&gt;&lt;div class=&quot;muted&quot;&gt;Total RGHS Patients&lt;/div&gt;&lt;div id=&quot;totalRghsPatients&quot; style=&quot;font-size:18px;font-weight:700&quot;&gt;—&lt;/div&gt;&lt;/div&gt;
      &lt;div class=&quot;card item&quot;&gt;&lt;div class=&quot;muted&quot;&gt;Total Patients&lt;/div&gt;&lt;div id=&quot;totalPatients&quot; style=&quot;font-size:18px;font-weight:700&quot;&gt;—&lt;/div&gt;&lt;/div&gt;
      &lt;div class=&quot;card item&quot;&gt;&lt;div class=&quot;muted&quot;&gt;Overall Total Amount (₹)&lt;/div&gt;&lt;div id=&quot;totalAmount&quot; style=&quot;font-size:18px;font-weight:700&quot;&gt;—&lt;/div&gt;&lt;/div&gt;
    &lt;/section&gt;

    &lt;div class=&quot;grid&quot;&gt;
      &lt;div class=&quot;card chart-area&quot;&gt;
        &lt;canvas id=&quot;patientsChart&quot; height=&quot;220&quot;&gt;&lt;/canvas&gt;
      &lt;/div&gt;

      &lt;div class=&quot;card&quot;&gt;
        &lt;h3 style=&quot;margin-top:0&quot;&gt;OPD Table&lt;/h3&gt;
        &lt;div style=&quot;overflow:auto;max-height:420px&quot;&gt;
          &lt;table&gt;
            &lt;thead&gt;
              &lt;tr&gt;
                &lt;th&gt;#&lt;/th&gt;
                &lt;th&gt;Doctor&lt;/th&gt;
                &lt;th&gt;Self OPD Patients&lt;/th&gt;
                &lt;th&gt;Self OPD Amount (₹)&lt;/th&gt;
                &lt;th&gt;RGHS Patients&lt;/th&gt;
                &lt;th&gt;RGHS Amount (₹)&lt;/th&gt;
                &lt;th&gt;Date&lt;/th&gt;
              &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody id=&quot;opdTableBody&quot;&gt;&lt;/tbody&gt;
          &lt;/table&gt;
        &lt;/div&gt;
        &lt;div style=&quot;margin-top:12px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap&quot;&gt;
          &lt;div class=&quot;muted&quot;&gt;Grand Total Patients: &lt;strong id=&quot;grandTotal&quot;&gt;—&lt;/strong&gt;&lt;/div&gt;
          &lt;div class=&quot;controls&quot;&gt;
            &lt;button id=&quot;downloadBtn&quot;&gt;Download HTML&lt;/button&gt;
            &lt;button id=&quot;printBtn&quot;&gt;Print&lt;/button&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;script&gt;
let allRecords = JSON.parse(localStorage.getItem('opdRecords')||'[]');
const toNum = v =&gt; v?Number(v):0;
const tbody=document.getElementById('opdTableBody');
const totalSelfEl=document.getElementById('totalSelfPatients');
const totalRghsEl=document.getElementById('totalRghsPatients');
const totalPatientsEl=document.getElementById('totalPatients');
const totalAmountEl=document.getElementById('totalAmount');
const dateFilter=document.getElementById('dateFilter');
const searchDoctor=document.getElementById('searchDoctor');
const ctx=document.getElementById('patientsChart').getContext('2d');
let chart=new Chart(ctx,{type:'bar',data:{labels:[],datasets:[]},options:{responsive:true,scales:{y:{beginAtZero:true}}}});

function saveLocal(){localStorage.setItem('opdRecords',JSON.stringify(allRecords));}

function render(){
  let filtered = allRecords;
  if(dateFilter.value){filtered = filtered.filter(r=&gt;r.date===dateFilter.value);}
  if(searchDoctor.value){
    const term = searchDoctor.value.toLowerCase();
    filtered = filtered.filter(r=&gt;r.doctor.toLowerCase().includes(term));
  }
  tbody.innerHTML='';
  filtered.forEach((r,i)=&gt;{
    const tr=document.createElement('tr');
    tr.innerHTML=`&lt;td&gt;${i+1}&lt;/td&gt;&lt;td&gt;${r.doctor}&lt;/td&gt;&lt;td&gt;${r.selfPatients}&lt;/td&gt;&lt;td&gt;₹${r.selfAmount}&lt;/td&gt;&lt;td&gt;${r.rghsPatients}&lt;/td&gt;&lt;td&gt;₹${r.rghsAmount}&lt;/td&gt;&lt;td&gt;${r.date||''}&lt;/td&gt;`;
    tbody.appendChild(tr);
  });
  const totalSelf=filtered.reduce((s,r)=&gt;s+toNum(r.selfPatients),0);
  const totalRghs=filtered.reduce((s,r)=&gt;s+toNum(r.rghsPatients),0);
  const totalAmt=filtered.reduce((s,r)=&gt;s+toNum(r.selfAmount)+toNum(r.rghsAmount),0);
  totalSelfEl.textContent=totalSelf;
  totalRghsEl.textContent=totalRghs;
  totalPatientsEl.textContent=totalSelf+totalRghs;
  totalAmountEl.textContent='₹'+totalAmt;
  chart.data.labels=filtered.map(r=&gt;r.doctor);
  chart.data.datasets=[{label:'Self OPD Patients',data:filtered.map(r=&gt;r.selfPatients),backgroundColor:'rgba(37,99,235,0.85)'},{label:'RGHS Patients',data:filtered.map(r=&gt;r.rghsPatients),backgroundColor:'rgba(16,185,129,0.85)'}];
  chart.update();
}

async function extractFromPdf(file){
  const buf=await file.arrayBuffer();
  const pdf=await pdfjsLib.getDocument({data:buf}).promise;
  let fullText='';
  for(let i=1;i&lt;=pdf.numPages;i++){
    const page=await pdf.getPage(i);
    const content=await page.getTextContent();
    fullText+=content.items.map(it=&gt;it.str).join(' ')+'\n';
  }
  const dateMatch=fullText.match(/(\d{2}-\d{2}-\d{4})/);
  const parsedDate = dateMatch?dateMatch[1]:new Date().toISOString().slice(0,10);
  const rowRegex=/(Dr\.\s+[A-Za-z ]+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)/g;
  let m; let rows=[];
  while((m=rowRegex.exec(fullText))!==null){
    rows.push({doctor:m[1].trim(),selfPatients:toNum(m[2]),selfAmount:toNum(m[3]),rghsPatients:toNum(m[4]),rghsAmount:toNum(m[5]),date:parsedDate});
  }
  allRecords.push(...rows);
  saveLocal();
  render();
}

document.getElementById('fileInput').addEventListener('change',ev=&gt;{
  const f=ev.target.files[0]; if(!f)return;
  if(f.name.endsWith('.pdf')) extractFromPdf(f);
  else if(f.name.endsWith('.json')){
    const reader=new FileReader();reader.onload=e=&gt;{const obj=JSON.parse(e.target.result);const rows=obj.data.map(r=&gt;({...r,date:obj.date}));allRecords.push(...rows);saveLocal();render();};reader.readAsText(f);
  } else if(f.name.endsWith('.csv')){
    const reader=new FileReader();reader.onload=e=&gt;{
      Papa.parse(e.target.result,{header:true,complete:res=&gt;{
        const rows=res.data.map(r=&gt;({doctor:r.doctor,selfPatients:toNum(r.selfPatients),selfAmount:toNum(r.selfAmount),rghsPatients:toNum(r.rghsPatients),rghsAmount:toNum(r.rghsAmount),date:r.date}));
        allRecords.push(...rows);saveLocal();render();
      }});
    };reader.readAsText(f);
  }
});

document.getElementById('exportExcel').addEventListener('click',()=&gt;{
  const ws = XLSX.utils.json_to_sheet(allRecords);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'OPD Records');
  XLSX.writeFile(wb, 'OPD_Records.xlsx');
});

dateFilter.addEventListener('change',render);
searchDoctor.addEventListener('input',render);

document.getElementById('loadSample').addEventListener('click',()=&gt;{
  const sample=[
    {doctor:'Dr. Taiyab Khan',selfPatients:122,selfAmount:20900,rghsPatients:51,rghsAmount:17850,date:'2025-09-18'},
    {doctor:'Dr. Somendra Kumar Sharma',selfPatients:88,selfAmount:15600,rghsPatients:42,rghsAmount:12000,date:'2025-09-18'}
  ];
  allRecords.push(...sample);
  saveLocal();
  render();
});

document.getElementById('clearData').addEventListener('click',()=&gt;{allRecords=[];localStorage.removeItem('opdRecords');render();});
document.getElementById('downloadBtn').addEventListener('click',()=&gt;{const html='&lt;!doctype html&gt;\n'+document.documentElement.outerHTML;const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='dashboard.html';a.click();});
document.getElementById('printBtn').addEventListener('click',()=&gt;window.print());

function updateClock(){document.getElementById('clock').textContent=new Date().toLocaleString('en-IN',{weekday:'short',year:'numeric',month:'short',day:'numeric'})+' — '+new Date().toLocaleTimeString('en-IN');}
setInterval(updateClock,1000);updateClock();

render();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</body>
</html>